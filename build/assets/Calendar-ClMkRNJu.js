import{r as o,j as e,F as B,a as y,c as b,b as L,d as z}from"./index-C_OMrv1E.js";import{B as I}from"./Breadcrumb-Br7EOIgD.js";import{L as k,A as v,D as w,T as N,B as D}from"./AdapterDateFns-By5AarWR.js";const J=({event:a,onSave:m,onClose:g})=>{const[h,p]=o.useState(""),[d,n]=o.useState(null),[u,x]=o.useState(null);o.useEffect(()=>{a&&(p(a.title||""),n(a.start_date||""),x(a.end_date||""))},[a]);const f=()=>{const s={id:a==null?void 0:a.id,title:h,start_date:d,end_date:u};m(s)};return e.jsx("div",{className:"modal",children:e.jsxs("div",{className:"modal-content",children:[e.jsx("h2",{className:"text-title-lg font-bold mb-5 mt-5",children:a!=null&&a.id?"Edit Event":"Add Event"}),e.jsxs("form",{children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"mb-3 block text-black dark:text-white",children:[e.jsx(B,{className:"inline-block mr-2"}),"Titulo del Registro"]}),e.jsx("input",{type:"text",className:"w-full rounded-lg border-[1.5px] border-stroke bg-transparent py-3 px-5 font-medium outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input dark:focus:border-primary",value:h,onChange:s=>p(s.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-3 block text-black dark:text-white",children:[e.jsx(y,{className:"inline-block mr-2"})," Fecha"]}),e.jsx("div",{className:"relative",children:e.jsx(k,{dateAdapter:v,children:e.jsx(w,{label:"Seleccione la fecha",value:d,className:"w-full rounded-lg border-[1.5px] border-stroke bg-transparent py-3 pl-10 pr-5 font-medium outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input dark:focus:border-primary",onChange:s=>n(s.target.value),renderInput:s=>e.jsx(N,{...s,fullWidth:!0}),format:"dd-MM-yyyy"})})})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-3 block text-black dark:text-white",children:[e.jsx(y,{className:"inline-block mr-2"})," Fecha"]}),e.jsx("div",{className:"relative",children:e.jsx(k,{dateAdapter:v,children:e.jsx(w,{label:"Seleccione la fecha",value:u,className:"w-full rounded-lg border-[1.5px] border-stroke bg-transparent py-3 pl-10 pr-5 font-medium outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input dark:focus:border-primary",onChange:s=>x(s.target.value),renderInput:s=>e.jsx(N,{...s,fullWidth:!0}),format:"dd-MM-yyyy"})})})]}),e.jsx(D,{onClick:f,variant:"contained",color:"primary",style:{marginTop:20,marginRight:20},children:"Guardar"}),e.jsx(D,{onClick:g,variant:"contained",color:"error",style:{marginTop:20},children:"Cancel"})]})]})})},O=()=>{const[a,m]=o.useState([]),[g,h]=o.useState(null),[p,d]=o.useState(!1),[n,u]=o.useState(new Date);o.useEffect(()=>{(async()=>{try{const t=await b.get("/api/events/getAll");Array.isArray(t.data)?m(t.data):console.error("Los datos de eventos no son un array:",t.data)}catch(t){console.error("Error al cargar eventos:",t)}})()},[]);const x=r=>{u(t=>new Date(t.getFullYear(),t.getMonth()+r,1))},f=r=>{u(t=>new Date(t.getFullYear()+r,t.getMonth(),1))},s=r=>a.filter(t=>{const i=new Date(t.start_date),l=new Date(t.end_date),c=new Date(r);return c>=i&&c<=l}),S=()=>{const r=new Date(n.getFullYear(),n.getMonth()+1,0).getDate(),t=new Date(n.getFullYear(),n.getMonth(),1).getDay(),i=[];for(let l=0;l<t;l++)i.push(e.jsx("td",{className:"border p-2"},`empty-${l}`));for(let l=1;l<=r;l++){const c=`${n.getFullYear()}-${(n.getMonth()+1).toString().padStart(2,"0")}-${l.toString().padStart(2,"0")}`,Y=s(c);i.push(e.jsxs("td",{className:"ease relative h-20 cursor-pointer border border-stroke p-2 transition duration-500 hover:bg-gray dark:border-strokedark dark:hover:bg-meta-4 md:h-25 md:p-6 xl:h-31",onClick:()=>E(c),children:[e.jsx("span",{className:"font-medium text-black dark:text-white",children:l}),Y.map((j,$)=>e.jsx("div",{className:"event-group",children:e.jsxs("div",{className:"event invisible absolute left-2 z-99 mb-1 flex w-[200%] flex-col rounded-sm border-l-[3px] border-primary bg-gray px-3 py-1 text-left opacity-0 group-hover:visible group-hover:opacity-100 dark:bg-meta-4 md:visible md:w-[190%] md:opacity-100",children:[e.jsx("span",{className:"event-name text-sm font-semibold text-black dark:text-white",children:j.title}),e.jsx("span",{className:"time text-sm font-medium text-black dark:text-white",children:c}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>M(j),className:"bg-primary hover:bg-primary-dark text-white rounded-full p-2",children:e.jsx(L,{})}),e.jsx("button",{onClick:()=>C(j.id),className:"bg-red hover:bg-primary-dark text-white rounded-full p-2",children:e.jsx(z,{})})]})]})},$))]},l))}return i},E=r=>{h({start_date:r,end_date:r,title:""}),d(!0)},M=r=>{h(r),d(!0)},C=async r=>{try{await b.delete(`/api/events/delete/${r}`),m(a.filter(t=>t.id!==r))}catch(t){console.error("Error al eliminar evento:",t)}},F=async r=>{try{r.id?await b.put(`/api/events/update/${r.id}`,r):await b.post("/api/events/create",r),d(!1);const t=await b.get("/api/events/getAll");m(t.data)}catch(t){console.error("Error al guardar evento:",t)}},A=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],_=n.getFullYear(),T=A[n.getMonth()];return e.jsxs(e.Fragment,{children:[e.jsx(I,{pageName:"Calendario"}),e.jsxs("div",{className:"w-full max-w-full rounded-sm border border-stroke bg-white shadow-default dark:border-strokedark dark:bg-boxdark",children:[e.jsxs("div",{className:"flex justify-between p-4",children:[e.jsx("button",{onClick:()=>f(-1),children:"Año Anteior"}),e.jsx("button",{onClick:()=>x(-1),children:"Mes Anteior"}),e.jsxs("span",{children:[T," ",_]}),e.jsx("button",{onClick:()=>x(1),children:"Siguiete Mes"}),e.jsx("button",{onClick:()=>f(1),children:"Siguiente Año"})]}),e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"grid grid-cols-7 rounded-t-sm bg-primary text-white",children:[e.jsx("th",{className:"flex h-15 items-center justify-center",children:"Domingo"}),e.jsx("th",{className:"flex h-15 items-center justify-center",children:"Lunes"}),e.jsx("th",{className:"flex h-15 items-center justify-center",children:"Martes"}),e.jsx("th",{className:"flex h-15 items-center justify-center",children:"Miércoles"}),e.jsx("th",{className:"flex h-15 items-center justify-center",children:"Jueves"}),e.jsx("th",{className:"flex h-15 items-center justify-center",children:"Viernes"}),e.jsx("th",{className:"flex h-15 items-center justify-center",children:"Sábado"})]})}),e.jsx("tbody",{children:e.jsx("tr",{className:"grid grid-cols-7",children:S()})})]})]}),p&&e.jsx(J,{event:g,onSave:F,onClose:()=>d(!1)})]})};export{O as default};
